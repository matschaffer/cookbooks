# You may need to manually edit this file to fit your needs.
# This configuration assumes the default installation prefix
# of /opt/graphite/, if you installed graphite somewhere else
# you will need to change all the occurances of /opt/graphite/
# in this file to your chosen install location.

<VirtualHost *:80>
  ServerName <%= node[:graphite][:graphite_web][:server_name] %> 
  DocumentRoot "<%= node[:graphite][:webapp_dir] %>"
  ErrorLog <%= node[:graphite][:log_dir] %>/webapp/error.log
  CustomLog <%= node[:graphite][:log_dir] %>/webapp/access.log common
  WSGIDaemonProcess graphite user=<%= node[:apache][:user] %> group=<%= node[:apache][:group] %> threads=<%= node[:graphite][:graphite_web][:threads] %>
  WSGIProcessGroup graphite
  WSGIScriptAlias / <%= node[:graphite][:webapp_dir] %>/graphite/graphite.wsgi
  <Directory <%= node[:graphite][:webapp_dir] %>>
      Order deny,allow
      Allow from all
  </Directory>
  Alias /media/ "<%= node[:graphite][:django_root] %>/contrib/admin/media/"
  <Directory <%= node[:graphite][:django_root] %>/contrib/admin/media>
      Order deny,allow
      Allow from all
  </Directory>

  <Location "/">
    SetHandler python-program
    PythonPath "['<%= node[:graphite][:webapp_dir] %>'] + sys.path"
    PythonHandler django.core.handlers.modpython
    SetEnv DJANGO_SETTINGS_MODULE graphite.settings
    PythonDebug Off
    PythonAutoReload Off
  </Location>

  <Location "/content/">
    SetHandler None
  </Location>

  <Location "/media/">
    SetHandler None
  </Location>

</VirtualHost>
